{% extends "AssoMakerBaseBundle::layout.html.twig"  %}

{% macro navBarItem(nom,route,params) %}
{% if params !="" %}
<li{% if route == app.request.attributes.get('_route') %} class="active" {% endif %}><a href="{{ path(route,params) }}">{{ nom }}</a></li>
{% else %}
<li{% if route == app.request.attributes.get('_route') %} class="active" {% endif %}><a href="{{ path(route) }}">{{ nom }}</a></li>
{% endif %}
{% endmacro %}

{% block navbar %}
	 				<li class="dropdown" id="menu_topnav_orgas">
					    <a class="dropdown-toggle" data-toggle="dropdown" href="">
					      Orgas
					      <b class="caret"></b>
					    </a>
					    <ul class="dropdown-menu">
				    		{{ _self.navBarItem('Liste','orga') }}
				    		{% if is_granted('ROLE_ADMIN') %}
					    		{{ _self.navBarItem('ListeHTML','orga_export') }}
								{{ _self.navBarItem('Créneaux d\'inscription','disponibiliteinscription') }}
								{{ _self.navBarItem('Missions','mission') }}
							{% endif %}
					    </ul>
					</li>
	       		{% if is_granted('ROLE_ADMIN') %}	
	       			{{ _self.navBarItem('Affectation','orga_affectation') }}
	       			{{ _self.navBarItem('Configuration','config') }}
	       		{% endif %}
	     		{% if is_granted('ROLE_USER') %}
	        		<li class="dropdown" id="menu_topnav_taches">
					    <a class="dropdown-toggle" data-toggle="dropdown" href="">
					      Fiches Tâches
					      <b class="caret"></b>
					    </a>
					    <ul class="dropdown-menu">
					    	{% if is_granted('ROLE_ADMIN') %}
							{{ _self.navBarItem('Fiches tâches','tache') }}
							{{ _self.navBarItem('Groupes de tâches','groupetache') }}
							{% else %}
							{{ _self.navBarItem('Mes Fiches','tache',{'orgaid': app.user.id}) }}
							{{ _self.navBarItem('Celles de ma com\'','tache',{'equipeid': app.user.equipe.id}) }}
							{{ _self.navBarItem('Groupes de tâches','groupetache',{'orgaid': app.user.id}) }}
							
							{% endif %}
					    </ul>
					</li>
	        		<li class="dropdown" id="menu_topnav_analyse">
					    <a class="dropdown-toggle" data-toggle="dropdown" href="">
					      Analyse
					      <b class="caret"></b>
					    </a>
					    <ul class="dropdown-menu">
							{{ _self.navBarItem('Statistiques','analyse_stats') }}
							{{ _self.navBarItem('Utilisation du matériel','analyse_usageMateriel') }}
							{{ _self.navBarItem('Orgas requis','analyse_plagesorga') }}
							{% if is_granted('ROLE_ADMIN') %}
							{{ _self.navBarItem('Besoins en orgas','analyse_besoinsorga') }}
							{{ _self.navBarItem('Orgas affectés','analyse_taches') }}
							{% endif %}
					    </ul>
					</li>
					{% if not is_granted('ROLE_ADMIN') %}
					{{ _self.navBarItem('Recherche des conflits','analyse_plagesorga',{'orgaid': app.user.id}) }}
					{{ _self.navBarItem('Mes Disponibilités','orga_inputdispos',{'id':app.user.id }) }}
					{% endif %}
	       			{{ _self.navBarItem('Charisme','orga_charisme') }}
	       		{% endif %}
	       		{% if is_granted('ROLE_VISITOR') %}	
	       		    {{ _self.navBarItem('Se déconnecter','logout') }}
	        	{% else %}
	       			{{ _self.navBarItem('Se connecter','login') }}
	        	{% endif %}
	            
	        	</ul>
	        	{% if is_granted('ROLE_USER') %}
		        	<form class="navbar-form pull-right form-search" method="post" action="{{ path('search') }}" id="search_form">
				           <input  class="input-medium search-query" id="searchBox" name="s" size="30" placeholder="Rechercher..." />		        		  
				    </form>
	        	{% endif %}
	        	
{% endblock %}


